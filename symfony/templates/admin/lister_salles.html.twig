{% extends 'basewithnavbar.html.twig' %}
{% block title %}Liste des salles{% endblock %}

{% block body %}
    <style>
        .example-wrapper { margin: 1em auto; max-width: 500px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
        /* BOUTONS */
        .styled {
            color: #fff;
            background-color: #007bff;
            border-color: #007bff;

            display: inline-block;
            font-weight: 400;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 0.25rem;
            transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
        }
        .btn:not(:disabled):not(.disabled) {
            cursor: pointer;
        }
        .table .thead-light th {
            color: #495057;
            background-color: #e9ecef;
            border-color: #dee2e6;
        }
        .table td, .table th {
            padding: 0.75rem;
            vertical-align: top;
            border-top: 1px solid #dee2e6;
            text-align: center;
        }
        .img {
            background-repeat: no-repeat;
            background-size: 100% 100%;
            background-position: 0 0;
            width:35px;
            height:35px;
        }
        .update {
            background-image: url({{ asset('img/crayon_blanc.png') }});
        }
        .delete {
            background-image: url({{ asset('img/poubelle.png') }});
        }

    </style>

    <script>
        function erreur()
        {
            alert("Il y a des systèmes dans cette salle ! " +
                "\n" +
                "Supprimez les ou changer les de salle avant de supprimer la salle.");
        }

        function openPopup(id)
        {
            var dialog = confirm("Supprimer la salle ? \n" +
                "Ceci ne la supprimera que s'il n'y a aucun système dans la salle \n" +
                "Sinon annulez et changez les systemes de salle d'abord");
            if (dialog) {
                document.location.href="/admin/database/supprimer_salle/"+id;
                if({{ ok }} == 0)
                {
                    erreur();
                }
            }
            else {
                document.location.href="/admin/database/lister_salles";

            }
        }
    </script>

    <div class="example-wrapper">
        <h1>Inventaire des Salles</h1>

        <!-- Lister Salles -->

        <table class="table">
            <thead class="thead-light">
            <tr>
                <th scope="col">Id</th>
                <th scope="col">Nom</th>
                <th scope="col">Modifier</th>
                <th scope="col">Supprimer</th>
            </tr>
            </thead>
            <tbody>
            {% for room in rooms %}
                <tr>
                    <td> {{ room.id }} </td>
                    <td> {{ room.name }} </td>
                    <!-- Supprimer Salle : faire requete pour suppr de la BD -->
                    <!--<td><button class="styled" type="button">Supprimer</button></td>-->
                    <td><a class="btn btn-primary img update favorite" href="/admin/database/modifier_salle/{{ room.id }}" role="button"></a></td>
                    <td><input class="btn btn-primary img delete favorite" type=button onclick="openPopup({{ room.id }})"></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <br><br>
        <!-- Ajouter Salle -->
        <a class="btn btn-primary" href="/admin/database/ajouter_salle" role="button">Ajouter une salle</a>
        <!--<a href="/admin/database/ajouter_salle"><button class="favorite styled" type="button">Ajouter une salle</button></a>-->

        <!-------------------- TESTS JSON ---------------------->

        <?php
        // chemin d'accès à votre fichier JSON
        $file = 'donneesCapteurs.json';
        // mettre le contenu du fichier dans une variable
        $data = file_get_contents($file);
        // décoder le flux JSON
        $obj = json_decode($data);
        // accéder à l'élément approprié
        echo $obj[0]->nameRoom;
        ?>
        <!------------------------------------------------------>

    </div>
{% endblock %}
