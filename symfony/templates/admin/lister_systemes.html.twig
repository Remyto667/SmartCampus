{% extends 'basewithnavbar.html.twig' %}

{% block title %}Inventaire des SA{% endblock %}

{% block body %}
    <style>
        /************** CSS **************/
        /**** General characteristics ****/
        body{
            background-color: #f7f9fa;
        }

        .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
        .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }

        /**** Table display ****/
        .table .thead-light th {
            color: #495057;
            background-color: #e9ecef;
            border-color: #dee2e6;
        }
        .table td, .table th {
            padding: 0.75rem;
            vertical-align: top;
            border-top: 1px solid #dee2e6;
            text-align: center;
        }

        /**** Buttons ****/
        .btn:not(:disabled):not(.disabled) {
            cursor: pointer;
        }

        .btn-primary {
            color: #fff;
            background-color: #00489a;
            border-color: #00489a;
        }

        .btn {
            display: inline-block;
            font-weight: 400;
            text-align: center;
            white-space: nowrap;
            vertical-align: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            border-radius: 0.25rem;
            transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
        }

        /**** Icons ****/
        .img {
            background-repeat: no-repeat;
            background-size: 100% 100%;
            background-position: 0 0;
            width:35px;
            height:35px;
        }
        .update {
            background-image: url({{ asset('img/crayon_blanc.png') }});
        }
        .delete {
            background-image: url({{ asset('img/poubelle.png') }});
        }
    </style>
    <script>
        function searchTable() {
            var input, filter, found, table, tr, td, i, j;
            input = document.getElementById("myInput");
            filter = input.value.toUpperCase();
            table = document.getElementById("table");
            tr = table.getElementsByTagName("tr");
            for (i = 1; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td");
                for (j = 0; j < td.length; j++) {
                    if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
                        found = true;
                    }
                }
                if (found) {
                    tr[i].style.display = "";
                    found = false;
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        function openPopup(id)
        {
            var dialog = confirm("Supprimer le systeme ? \n" +
                "Ceci supprimera tous les capteurs de ce système \n" +
                "Sinon annulez et changez les capteurs de système d'abord");
            if (dialog) {
                document.location.href="/inventaire/supprimer_systeme/"+id;

            }
            else {
                document.location.href="/inventaire/lister_systemes";
            }
        }
    </script>

    <div class="example-wrapper">

        <h1> Inventaire des Systèmes d'acquisition </h1>
        <br>
        <br>
        <span class="h6">Recherche: <label for="myInput"></label><input id="myInput" onkeyup="searchTable()" type="text" class="form-control form-control-lg"></span>
        <br><br>
        <table class="table" id="table">
            <thead class="table thead-light">
            <tr>
                <th scope="col">Nom du système</th>
                <th scope="col">Tag</th>
                <th scope="col">Salle</th>
                <th scope="col">Nombre de capteurs</th>
                <th scope="col">Options</th>
            </tr>
            </thead>
            <tbody>
            {% for system in systems %}
                <tr>
                    <td> {{ system.name }}</td>
                    <td> {{ system.tag }}</td>
                    <td> {{ system.room.name }} </td>


                    {% for key,value in nbsensor %}
                        {% if value.id == system.id %}
                            <td> {{ value.nb }}</td>
                        {% endif %}
                    {% endfor %}
                    <td>
                        <a class="btn btn-primary img update favorite" href="/inventaire/modifier_systeme/{{ system.id }}" role="button" > </a> <input class="btn btn-primary img delete favorite" type=button onclick="openPopup({{ system.id }})"> </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

        <a class="btn btn-primary favorite" href="/inventaire/ajouter_systeme" role="button">Ajouter un Systeme</a>

    </div>
{% endblock %}
